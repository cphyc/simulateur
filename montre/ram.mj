regn<n>(enable,i:[n]) = o:[n]
where
	if n = 0 then
		o = []
	else
		o = reg(mux(enable,i[0],o[0])).regn<n-1>(enable,i[1..n-1]);
	end if
end where

ram_module<n>(write_addr:[n], read_addr:[n], wen, data:[n]) = o:[n]
where
	write_enable = mux(write_addr[n-1],0,wen);
	real_read_addr = muxn<n>(read_addr[n-1],zero<n>(),read_addr);
	mem = ram<n,n>(real_read_addr,write_enable,write_addr,data);
	o = muxn<n>(read_addr[n-1],zero<n>(),mem);
end where

